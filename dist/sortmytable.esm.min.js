/** SortMyTable 1.0.0 @license https://github.com/mysociety/sortmytable */
class t{static defaults={formatHeaderButton:function(t){t.setAttribute("type","button"),t.insertAdjacentHTML("beforeend",'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 16" width="32" height="16" focusable="false" aria-hidden="true"><path class="up" d="M8.16 3.33a1 1 0 0 1 1.68 0l5.18 8.13a1 1 0 0 1-.84 1.54H3.82a1 1 0 0 1-.84-1.54l5.18-8.13Z"/><path class="down" d="M23.84 12.67a1 1 0 0 1-1.68 0l-5.18-8.13A1 1 0 0 1 17.82 3h10.36a1 1 0 0 1 .84 1.54l-5.18 8.13Z"/></svg>')},getSortableHeaders:function(t){return t.querySelectorAll("thead th")},getSortableRows:function(t){return this.getSortedRowsContainer(t).querySelectorAll("tr")},getSortableValue:function(t){let e;return e=void 0!==t.dataset.sortableValue?t.dataset.sortableValue:t.textContent,""===e||null==e?"":Number.isNaN(Number(e))?String(e):Number(e)},getSortedRowsContainer:function(t){return t.querySelector("tbody")},onSort:function(t,e,n){}};constructor(e,r){if(this.init=this.init.bind(this),this.createHeaderButtons=this.createHeaderButtons.bind(this),this.storeInitialSortOrder=this.storeInitialSortOrder.bind(this),this.sort=this.sort.bind(this),this.settings=Object.assign({},t.defaults,r),"string"==typeof e&&(e=document.querySelectorAll(e)),NodeList.prototype.isPrototypeOf(e)){if(1===e.length)return this.init(e[0]);this.instances=Array.from(e).map((function(e){return new t(e,r)}))}else{if(n(e))return this.init(e);if("object"==typeof e&&"jquery"in e){if(1===e.length)return this.init(e[0]);this.instances=e.get().map((function(e){return new t(e,r)}))}}}init(t){return t.sortmytable?t.sortmytable:(t.sortmytable=this,this.tableElement=t,this.storeInitialSortOrder(),this.createHeaderButtons(),this)}createHeaderButtons(){const t=this;t.settings.getSortableHeaders(t.tableElement).forEach((function(n,r){let i=e("button",n)[0];void 0===i&&(s(n,"button"),i=e("button",n)[0]),t.settings.formatHeaderButton(i),i.addEventListener("click",(function(){const e=n.getAttribute("aria-sort");null===e?t.sort(n,"ascending"):"ascending"===e?t.sort(n,"descending"):"descending"===e&&t.sort()}))}))}storeInitialSortOrder(){const t=this.settings.getSortableHeaders(this.tableElement),e=o(t,"[aria-sort]");1===e.length?(this.initialSortColumn=e[0],this.initialSortDirection=e[0].getAttribute("aria-sort")):this.settings.getSortableRows(this.tableElement).forEach((function(t,e){t.dataset.initialSortIndex=e}))}sort(t,e){const o=this;if(void 0===t)if(void 0!==o.initialSortColumn&&void 0!==o.initialSortDirection)o.sort(o.initialSortColumn,o.initialSortDirection);else{Array.from(o.settings.getSortableRows(o.tableElement)).sort((function(t,e){return t.dataset.initialSortIndex-e.dataset.initialSortIndex})).forEach((function(t){o.settings.getSortedRowsContainer(o.tableElement).appendChild(t)})),o.settings.getSortableHeaders(o.tableElement).forEach((function(t,e){t.removeAttribute("aria-sort")})),o.settings.onSort(o.tableElement)}else if(n(t)&&o.tableElement.contains(t))o.sort(i(t).length,e);else if(r(t)){let n=Array.from(o.settings.getSortableRows(o.tableElement)).sort((function(e,n){const i=o.settings.getSortableValue(e.children[t]),s=o.settings.getSortableValue(n.children[t]);return r(i)&&r(s)?i-s:i.toString().localeCompare(s)}));"descending"===e&&(n=n.reverse()),n.forEach((function(t){o.settings.getSortedRowsContainer(o.tableElement).appendChild(t)})),o.settings.getSortableHeaders(o.tableElement).forEach((function(n,r){r===t?n.setAttribute("aria-sort",e):n.removeAttribute("aria-sort")})),o.settings.onSort(o.tableElement,t,e)}}}const e=function(t,e=document){return e.querySelectorAll(t)},n=function(t){return Node.prototype.isPrototypeOf(t)},r=function(t){return"number"==typeof t},i=function(t){const e=[];for(;t=t.previousElementSibling;)e.push(t);return e},o=function(t,e){return Array.from(t).filter((function(t){return t.matches(e)}))},s=function(t,e="div"){for("string"==typeof e&&(e=document.createElement(e)),t.appendChild(e);t.firstChild!==e;)e.appendChild(t.firstChild);return t};export{t as SortMyTable};
